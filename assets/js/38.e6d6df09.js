(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{449:function(v,_,t){"use strict";t.r(_);var e=t(26),o=Object(e.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("h1",{attrs:{id:"性能"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#性能"}},[v._v("#")]),v._v(" 性能")]),v._v(" "),t("ul",[t("li",[v._v("HTML 文档结构层次尽量少，最好不深于六层；")]),v._v(" "),t("li",[v._v("脚本尽量后放，放在 body 前即可；")]),v._v(" "),t("li",[v._v("少量首屏样式内联放在标签内；")]),v._v(" "),t("li",[v._v("样式结构层次尽量简单；")]),v._v(" "),t("li",[v._v("在脚本中尽量减少 DOM 操作，尽量缓存访问 DOM 的样式信息，避免过度触发回流；")]),v._v(" "),t("li",[v._v("减少通过 JavaScript 代码修改元素样式，尽量使用修改 class 名方式操作样式或动画；")]),v._v(" "),t("li",[v._v("动画尽量使用在绝对定位或固定定位的元素上；")]),v._v(" "),t("li",[v._v("隐藏在屏幕外，或在页面滚动时，尽量停止动画；")]),v._v(" "),t("li",[v._v("尽量缓存 DOM 查找，查找器尽量简洁；")]),v._v(" "),t("li",[v._v("涉及多域名的网站，可以开启域名预解析")])]),v._v(" "),t("h2",{attrs:{id:"回流、重绘、合成"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#回流、重绘、合成"}},[v._v("#")]),v._v(" 回流、重绘、合成")]),v._v(" "),t("h3",{attrs:{id:"回流-也叫重排"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#回流-也叫重排"}},[v._v("#")]),v._v(" 回流（也叫重排）")]),v._v(" "),t("p",[v._v("触发条件：对 DOM 结构的修改引发 DOM 几何尺寸变化的时候")]),v._v(" "),t("p",[v._v("有以下的操作会触发回流:")]),v._v(" "),t("ol",[t("li",[v._v("一个 DOM 元素的几何属性变化，常见的几何属性有 "),t("code",[v._v("width")]),v._v("、"),t("code",[v._v("height")]),v._v("、"),t("code",[v._v("padding")]),v._v("、"),t("code",[v._v("margin")]),v._v("、"),t("code",[v._v("left")]),v._v("、"),t("code",[v._v("top")]),v._v("、"),t("code",[v._v("border")]),v._v(" 等等, 这个很好理解。")]),v._v(" "),t("li",[v._v("使 DOM 节点发生增减或者移动。")]),v._v(" "),t("li",[v._v("读写 "),t("code",[v._v("offset")]),v._v(" 族、"),t("code",[v._v("scroll")]),v._v(" 族和 "),t("code",[v._v("client")]),v._v(" 族属性的时候，浏览器为了获取这些值，需要进行回流操作。")]),v._v(" "),t("li",[v._v("调用 "),t("code",[v._v("window.getComputedStyle")]),v._v(" 方法。")])]),v._v(" "),t("p",[v._v("一些常用且会导致回流的属性和方法：")]),v._v(" "),t("ul",[t("li",[v._v("clientWidth、clientHeight、clientTop、clientLeft")]),v._v(" "),t("li",[v._v("offsetWidth、offsetHeight、offsetTop、offsetLeft")]),v._v(" "),t("li",[v._v("scrollWidth、scrollHeight、scrollTop、scrollLeft")]),v._v(" "),t("li",[v._v("scrollIntoView()、scrollIntoViewIfNeeded()")]),v._v(" "),t("li",[v._v("getComputedStyle()")]),v._v(" "),t("li",[v._v("getBoundingClientRect()")]),v._v(" "),t("li",[v._v("scrollTo()")])]),v._v(" "),t("p",[v._v("生成 Dom 树（若 Dom 结构改变） -> 计算样式 -> 生成布局树 -> 图层树 -> 绘制")]),v._v(" "),t("h3",{attrs:{id:"重绘"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#重绘"}},[v._v("#")]),v._v(" 重绘")]),v._v(" "),t("p",[v._v("当页面中元素样式的改变并不影响它在文档流中的位置时（例如：color、background-color、visibility 等），浏览器会将新样式赋予给元素并重新绘制它，这个过程称为重绘。\n根据概念，我们知道由于没有导致 DOM 几何属性的变化，因此元素的位置信息不需要更新，从而省去布局的过程，流程如下：")]),v._v(" "),t("p",[v._v("计算样式 -> 绘制")]),v._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[v._v("TIP")]),v._v(" "),t("p",[v._v("重绘不一定导致回流")]),v._v(" "),t("p",[v._v("回流一定发生了重绘")])]),v._v(" "),t("h3",{attrs:{id:"合成"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#合成"}},[v._v("#")]),v._v(" 合成")]),v._v(" "),t("p",[v._v("更改了一个既不要布局也不要绘制的属性，那么渲染引擎会跳过布局和绘制，直接执行后续的合成操作，这个过程就叫合成")]),v._v(" "),t("p",[v._v("比如使用 CSS 的 "),t("code",[v._v("transform")]),v._v(" 来实现动画效果，避免了回流跟重绘，直接在非主线程中执行合成动画操作。显然这样子的效率更高，毕竟这个是在非主线程上合成的，没有占用主线程资源，另外也避开了布局和绘制两个子阶段，所以相对于重绘和重排，合成能大大提升绘制效率。")]),v._v(" "),t("h3",{attrs:{id:"相关最佳实践"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#相关最佳实践"}},[v._v("#")]),v._v(" 相关最佳实践")]),v._v(" "),t("ul",[t("li",[v._v("使用 "),t("code",[v._v("createDocumentFragment")]),v._v(" 进行批量的 DOM 操作")]),v._v(" "),t("li",[v._v("对于 "),t("code",[v._v("resize")]),v._v("、"),t("code",[v._v("scroll")]),v._v(" 等进行防抖/节流处理。")]),v._v(" "),t("li",[v._v("动画使用 "),t("code",[v._v("transform")]),v._v(" 或者 "),t("code",[v._v("opacity")]),v._v(" 实现")]),v._v(" "),t("li",[v._v("将元素的 "),t("code",[v._v("will-change")]),v._v(" 设置为 "),t("code",[v._v("opacity")]),v._v("、"),t("code",[v._v("transform")]),v._v("、"),t("code",[v._v("top")]),v._v("、"),t("code",[v._v("left")]),v._v("、"),t("code",[v._v("bottom")]),v._v("、"),t("code",[v._v("right")]),v._v(" 。这样子渲染引擎会为其单独实现一个图层，当这些变换发生时，仅仅只是利用合成线程去处理这些变换，而不牵扯到主线程，大大提高渲染效率。")]),v._v(" "),t("li",[v._v("对于不支持 "),t("code",[v._v("will-change")]),v._v(" 属性的浏览器，使用一个 "),t("code",[v._v("3D transform")]),v._v(" 属性来强制提升为合成 "),t("code",[v._v("transform: translateZ(0)")]),v._v(";")]),v._v(" "),t("li",[t("code",[v._v("rAF")]),v._v(" 优化等等")])])])}),[],!1,null,null,null);_.default=o.exports}}]);