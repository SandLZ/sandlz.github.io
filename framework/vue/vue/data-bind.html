<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>双向绑定 | SandLZ</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="favicon.png">
    <meta name="description" content="This is blog create by SandLZ.">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.e7fb8e99.css" as="style"><link rel="preload" href="/assets/js/app.3cc20051.js" as="script"><link rel="preload" href="/assets/js/3.d21fe4c7.js" as="script"><link rel="preload" href="/assets/js/141.e7473c8f.js" as="script"><link rel="prefetch" href="/assets/js/10.5900fce3.js"><link rel="prefetch" href="/assets/js/100.60783ded.js"><link rel="prefetch" href="/assets/js/101.1135013e.js"><link rel="prefetch" href="/assets/js/102.bc74adb0.js"><link rel="prefetch" href="/assets/js/103.a039ccd8.js"><link rel="prefetch" href="/assets/js/104.6a281114.js"><link rel="prefetch" href="/assets/js/105.7b027bba.js"><link rel="prefetch" href="/assets/js/106.269e2f91.js"><link rel="prefetch" href="/assets/js/107.2d77b595.js"><link rel="prefetch" href="/assets/js/108.dd5d2bb5.js"><link rel="prefetch" href="/assets/js/109.4a1b6dda.js"><link rel="prefetch" href="/assets/js/11.9446dd7d.js"><link rel="prefetch" href="/assets/js/110.a7afafd9.js"><link rel="prefetch" href="/assets/js/111.000eff86.js"><link rel="prefetch" href="/assets/js/112.a5af53af.js"><link rel="prefetch" href="/assets/js/113.332c72e8.js"><link rel="prefetch" href="/assets/js/114.c5b4e9b1.js"><link rel="prefetch" href="/assets/js/115.f90596bd.js"><link rel="prefetch" href="/assets/js/116.ca3db9e0.js"><link rel="prefetch" href="/assets/js/117.13b378cc.js"><link rel="prefetch" href="/assets/js/118.a6a3c112.js"><link rel="prefetch" href="/assets/js/119.7245d38f.js"><link rel="prefetch" href="/assets/js/12.c64430aa.js"><link rel="prefetch" href="/assets/js/120.f68571b2.js"><link rel="prefetch" href="/assets/js/121.5963d2ff.js"><link rel="prefetch" href="/assets/js/122.df86435a.js"><link rel="prefetch" href="/assets/js/123.08478671.js"><link rel="prefetch" href="/assets/js/124.74bc54a8.js"><link rel="prefetch" href="/assets/js/125.c6491798.js"><link rel="prefetch" href="/assets/js/126.ab6fe3a0.js"><link rel="prefetch" href="/assets/js/127.e476782f.js"><link rel="prefetch" href="/assets/js/128.12deadc5.js"><link rel="prefetch" href="/assets/js/129.70edf24c.js"><link rel="prefetch" href="/assets/js/13.d754c8c1.js"><link rel="prefetch" href="/assets/js/130.63de3341.js"><link rel="prefetch" href="/assets/js/131.02c73a5e.js"><link rel="prefetch" href="/assets/js/132.9a734544.js"><link rel="prefetch" href="/assets/js/133.80192eb1.js"><link rel="prefetch" href="/assets/js/134.e00f91f3.js"><link rel="prefetch" href="/assets/js/135.86d36874.js"><link rel="prefetch" href="/assets/js/136.573acffe.js"><link rel="prefetch" href="/assets/js/137.8116e591.js"><link rel="prefetch" href="/assets/js/138.e527d51b.js"><link rel="prefetch" href="/assets/js/139.df2477f2.js"><link rel="prefetch" href="/assets/js/14.c04ea5e3.js"><link rel="prefetch" href="/assets/js/140.2afa1919.js"><link rel="prefetch" href="/assets/js/142.d100eefe.js"><link rel="prefetch" href="/assets/js/143.79b0291a.js"><link rel="prefetch" href="/assets/js/144.ebee833c.js"><link rel="prefetch" href="/assets/js/145.dc7ac387.js"><link rel="prefetch" href="/assets/js/146.54635c6b.js"><link rel="prefetch" href="/assets/js/147.05bcdcd3.js"><link rel="prefetch" href="/assets/js/148.4960e225.js"><link rel="prefetch" href="/assets/js/149.59b914ee.js"><link rel="prefetch" href="/assets/js/15.113851c9.js"><link rel="prefetch" href="/assets/js/150.00a0a2f9.js"><link rel="prefetch" href="/assets/js/151.2da3059f.js"><link rel="prefetch" href="/assets/js/152.1a9463d3.js"><link rel="prefetch" href="/assets/js/153.1931c77f.js"><link rel="prefetch" href="/assets/js/154.f32c9f92.js"><link rel="prefetch" href="/assets/js/155.4c8be4d2.js"><link rel="prefetch" href="/assets/js/156.eeb93d57.js"><link rel="prefetch" href="/assets/js/16.7c40ed91.js"><link rel="prefetch" href="/assets/js/17.243aa7d0.js"><link rel="prefetch" href="/assets/js/18.d257d906.js"><link rel="prefetch" href="/assets/js/19.04c2f838.js"><link rel="prefetch" href="/assets/js/2.ce40fe5e.js"><link rel="prefetch" href="/assets/js/20.e70d3180.js"><link rel="prefetch" href="/assets/js/21.dacb1ece.js"><link rel="prefetch" href="/assets/js/22.cc75cdc2.js"><link rel="prefetch" href="/assets/js/23.0c7ed24f.js"><link rel="prefetch" href="/assets/js/24.7f376544.js"><link rel="prefetch" href="/assets/js/25.18c08c90.js"><link rel="prefetch" href="/assets/js/26.36ca87e0.js"><link rel="prefetch" href="/assets/js/27.c0bc33e5.js"><link rel="prefetch" href="/assets/js/28.c2bbee26.js"><link rel="prefetch" href="/assets/js/29.f3767e3d.js"><link rel="prefetch" href="/assets/js/30.914fd1ac.js"><link rel="prefetch" href="/assets/js/31.4c68e199.js"><link rel="prefetch" href="/assets/js/32.719e1558.js"><link rel="prefetch" href="/assets/js/33.61465500.js"><link rel="prefetch" href="/assets/js/34.776571a3.js"><link rel="prefetch" href="/assets/js/35.a7b2685e.js"><link rel="prefetch" href="/assets/js/36.088ce3bc.js"><link rel="prefetch" href="/assets/js/37.ea145603.js"><link rel="prefetch" href="/assets/js/38.f9ec9bce.js"><link rel="prefetch" href="/assets/js/39.312aa8b4.js"><link rel="prefetch" href="/assets/js/4.1c9fc30a.js"><link rel="prefetch" href="/assets/js/40.7ba42395.js"><link rel="prefetch" href="/assets/js/41.6dc4dd00.js"><link rel="prefetch" href="/assets/js/42.c3e99378.js"><link rel="prefetch" href="/assets/js/43.f63eef3a.js"><link rel="prefetch" href="/assets/js/44.9f181df0.js"><link rel="prefetch" href="/assets/js/45.caf1a62e.js"><link rel="prefetch" href="/assets/js/46.848aaae7.js"><link rel="prefetch" href="/assets/js/47.38a7106e.js"><link rel="prefetch" href="/assets/js/48.ae563a96.js"><link rel="prefetch" href="/assets/js/49.d828c121.js"><link rel="prefetch" href="/assets/js/5.2b2fffff.js"><link rel="prefetch" href="/assets/js/50.e60642ca.js"><link rel="prefetch" href="/assets/js/51.b735a275.js"><link rel="prefetch" href="/assets/js/52.6edea666.js"><link rel="prefetch" href="/assets/js/53.40c5c958.js"><link rel="prefetch" href="/assets/js/54.3d2ff174.js"><link rel="prefetch" href="/assets/js/55.29e2f7c5.js"><link rel="prefetch" href="/assets/js/56.6c90e11b.js"><link rel="prefetch" href="/assets/js/57.99897c26.js"><link rel="prefetch" href="/assets/js/58.440e44d2.js"><link rel="prefetch" href="/assets/js/59.2ad50e76.js"><link rel="prefetch" href="/assets/js/6.ea9ff7e0.js"><link rel="prefetch" href="/assets/js/60.ea2e5627.js"><link rel="prefetch" href="/assets/js/61.cc88829d.js"><link rel="prefetch" href="/assets/js/62.bad45ce0.js"><link rel="prefetch" href="/assets/js/63.be077a4e.js"><link rel="prefetch" href="/assets/js/64.e50497e6.js"><link rel="prefetch" href="/assets/js/65.bc3148c8.js"><link rel="prefetch" href="/assets/js/66.5a417eaa.js"><link rel="prefetch" href="/assets/js/67.da19587c.js"><link rel="prefetch" href="/assets/js/68.6cabdbae.js"><link rel="prefetch" href="/assets/js/69.ac097ff2.js"><link rel="prefetch" href="/assets/js/7.3b129485.js"><link rel="prefetch" href="/assets/js/70.a8f658f1.js"><link rel="prefetch" href="/assets/js/71.c372400a.js"><link rel="prefetch" href="/assets/js/72.bdcb4ca1.js"><link rel="prefetch" href="/assets/js/73.70eb1c8d.js"><link rel="prefetch" href="/assets/js/74.6d35e831.js"><link rel="prefetch" href="/assets/js/75.3202d4bd.js"><link rel="prefetch" href="/assets/js/76.83a6fec5.js"><link rel="prefetch" href="/assets/js/77.633c4d36.js"><link rel="prefetch" href="/assets/js/78.c5343b60.js"><link rel="prefetch" href="/assets/js/79.3f3f3bd8.js"><link rel="prefetch" href="/assets/js/8.c6d13d6b.js"><link rel="prefetch" href="/assets/js/80.7f041619.js"><link rel="prefetch" href="/assets/js/81.d58d0279.js"><link rel="prefetch" href="/assets/js/82.41e6fc03.js"><link rel="prefetch" href="/assets/js/83.4747489e.js"><link rel="prefetch" href="/assets/js/84.58f91fb7.js"><link rel="prefetch" href="/assets/js/85.7be7b880.js"><link rel="prefetch" href="/assets/js/86.42e36528.js"><link rel="prefetch" href="/assets/js/87.832729a3.js"><link rel="prefetch" href="/assets/js/88.1b595e90.js"><link rel="prefetch" href="/assets/js/89.e82ad4e7.js"><link rel="prefetch" href="/assets/js/9.53d264ef.js"><link rel="prefetch" href="/assets/js/90.fd5f264d.js"><link rel="prefetch" href="/assets/js/91.a0b47889.js"><link rel="prefetch" href="/assets/js/92.3d83b7f4.js"><link rel="prefetch" href="/assets/js/93.52843fe1.js"><link rel="prefetch" href="/assets/js/94.d94ffd86.js"><link rel="prefetch" href="/assets/js/95.46b054ad.js"><link rel="prefetch" href="/assets/js/96.82432c4c.js"><link rel="prefetch" href="/assets/js/97.d62f54a0.js"><link rel="prefetch" href="/assets/js/98.9b0082c2.js"><link rel="prefetch" href="/assets/js/99.d3ed22fd.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e7fb8e99.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">SandLZ</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机" class="dropdown-title"><span class="title">计算机</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机" class="mobile-dropdown-title"><span class="title">计算机</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/computer/compile/" class="nav-link">
  编译原理
</a></li><li class="dropdown-subitem"><a href="/computer/communication-protocol/" class="nav-link">
  通信协议
</a></li></ul></li><li class="dropdown-item"><h4>
          进阶
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/computer/data-structure/" class="nav-link">
  数据结构
</a></li><li class="dropdown-subitem"><a href="/computer/algorithm/" class="nav-link">
  算法
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础" class="dropdown-title"><span class="title">基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="基础" class="mobile-dropdown-title"><span class="title">基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          三剑客
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/base/html/semantization.html" class="nav-link">
  HTML
</a></li><li class="dropdown-subitem"><a href="/base/css/base.html" class="nav-link">
  CSS
</a></li><li class="dropdown-subitem"><a href="/base/javascript/data-type.html" class="nav-link">
  JavaScript
</a></li></ul></li><li class="dropdown-item"><h4>
          浏览器
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/base/browser/" class="nav-link">
  Browser
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="进阶" class="dropdown-title"><span class="title">进阶</span> <span class="arrow down"></span></button> <button type="button" aria-label="进阶" class="mobile-dropdown-title"><span class="title">进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advance/design-patterns/" class="nav-link">
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/advance/architecture-mode/" class="nav-link">
  架构模式
</a></li><li class="dropdown-item"><!----> <a href="/advance/programe-paradigms/" class="nav-link">
  编程范型
</a></li><li class="dropdown-item"><!----> <a href="/advance/programe-design/" class="nav-link">
  程序设计
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="进阶" class="dropdown-title"><span class="title">工程化</span> <span class="arrow down"></span></button> <button type="button" aria-label="进阶" class="mobile-dropdown-title"><span class="title">工程化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/engineering/ci-cd/" class="nav-link">
  CI/CD
</a></li><li class="dropdown-item"><!----> <a href="/engineering/code-standard/code-format.html" class="nav-link">
  代码规范
</a></li><li class="dropdown-item"><!----> <a href="/engineering/code-quality/unit-test.html" class="nav-link">
  代码质量
</a></li><li class="dropdown-item"><h4>
          版本管理
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/engineering/version-manage/git.html" class="nav-link">
  Git
</a></li></ul></li><li class="dropdown-item"><h4>
          转换工具
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/engineering/trans-tool/babel.html" class="nav-link">
  Babel
</a></li></ul></li><li class="dropdown-item"><h4>
          构建工具
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/engineering/build-tool/webpack.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-subitem"><a href="/engineering/build-tool/rollup.html" class="nav-link">
  Rollup
</a></li></ul></li><li class="dropdown-item"><h4>
          语言增强
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/engineering/lan-enhancement/scss/scss.html" class="nav-link">
  Scss
</a></li><li class="dropdown-subitem"><a href="/engineering/lan-enhancement/typescript.html" class="nav-link">
  TypeScript
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          FE
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/vue/" class="nav-link router-link-active">
  Vue
</a></li><li class="dropdown-subitem"><a href="/framework/react/" class="nav-link">
  React
</a></li><li class="dropdown-subitem"><a href="/framework/angular/" class="nav-link">
  Angular
</a></li></ul></li><li class="dropdown-item"><h4>
          BE
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/nodejs/" class="nav-link">
  Node.js
</a></li><li class="dropdown-subitem"><a href="/backend/express/" class="nav-link">
  Express
</a></li><li class="dropdown-subitem"><a href="/backend/koa/" class="nav-link">
  Koa
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="客户端" class="dropdown-title"><span class="title">客户端</span> <span class="arrow down"></span></button> <button type="button" aria-label="客户端" class="mobile-dropdown-title"><span class="title">客户端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/client/jsbridge/" class="nav-link">
  JSBridge
</a></li><li class="dropdown-item"><!----> <a href="/client/electron/" class="nav-link">
  Electron
</a></li><li class="dropdown-item"><!----> <a href="/client/react-native/" class="nav-link">
  React Native
</a></li><li class="dropdown-item"><!----> <a href="/client/flutter/" class="nav-link">
  Flutter
</a></li><li class="dropdown-item"><!----> <a href="/client/cordova/" class="nav-link">
  Cordova
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具" class="mobile-dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          SEO
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/tool/seo/gtm.html" class="nav-link">
  GTM
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端发展" class="dropdown-title"><span class="title">前端发展</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端发展" class="mobile-dropdown-title"><span class="title">前端发展</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend-development/ssr/" class="nav-link">
  SSR
</a></li><li class="dropdown-item"><!----> <a href="/frontend-development/micro-frontend/" class="nav-link">
  微前端
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/other/team/private-npm.html" class="nav-link">
  团队协作
</a></li><li class="dropdown-item"><!----> <a href="/other/project-manage/" class="nav-link">
  项目管理
</a></li><li class="dropdown-item"><!----> <a href="/other/design/" class="nav-link">
  架构设计
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/SandLZ" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机" class="dropdown-title"><span class="title">计算机</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机" class="mobile-dropdown-title"><span class="title">计算机</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          基础
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/computer/compile/" class="nav-link">
  编译原理
</a></li><li class="dropdown-subitem"><a href="/computer/communication-protocol/" class="nav-link">
  通信协议
</a></li></ul></li><li class="dropdown-item"><h4>
          进阶
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/computer/data-structure/" class="nav-link">
  数据结构
</a></li><li class="dropdown-subitem"><a href="/computer/algorithm/" class="nav-link">
  算法
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础" class="dropdown-title"><span class="title">基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="基础" class="mobile-dropdown-title"><span class="title">基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          三剑客
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/base/html/semantization.html" class="nav-link">
  HTML
</a></li><li class="dropdown-subitem"><a href="/base/css/base.html" class="nav-link">
  CSS
</a></li><li class="dropdown-subitem"><a href="/base/javascript/data-type.html" class="nav-link">
  JavaScript
</a></li></ul></li><li class="dropdown-item"><h4>
          浏览器
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/base/browser/" class="nav-link">
  Browser
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="进阶" class="dropdown-title"><span class="title">进阶</span> <span class="arrow down"></span></button> <button type="button" aria-label="进阶" class="mobile-dropdown-title"><span class="title">进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advance/design-patterns/" class="nav-link">
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/advance/architecture-mode/" class="nav-link">
  架构模式
</a></li><li class="dropdown-item"><!----> <a href="/advance/programe-paradigms/" class="nav-link">
  编程范型
</a></li><li class="dropdown-item"><!----> <a href="/advance/programe-design/" class="nav-link">
  程序设计
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="进阶" class="dropdown-title"><span class="title">工程化</span> <span class="arrow down"></span></button> <button type="button" aria-label="进阶" class="mobile-dropdown-title"><span class="title">工程化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/engineering/ci-cd/" class="nav-link">
  CI/CD
</a></li><li class="dropdown-item"><!----> <a href="/engineering/code-standard/code-format.html" class="nav-link">
  代码规范
</a></li><li class="dropdown-item"><!----> <a href="/engineering/code-quality/unit-test.html" class="nav-link">
  代码质量
</a></li><li class="dropdown-item"><h4>
          版本管理
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/engineering/version-manage/git.html" class="nav-link">
  Git
</a></li></ul></li><li class="dropdown-item"><h4>
          转换工具
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/engineering/trans-tool/babel.html" class="nav-link">
  Babel
</a></li></ul></li><li class="dropdown-item"><h4>
          构建工具
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/engineering/build-tool/webpack.html" class="nav-link">
  Webpack
</a></li><li class="dropdown-subitem"><a href="/engineering/build-tool/rollup.html" class="nav-link">
  Rollup
</a></li></ul></li><li class="dropdown-item"><h4>
          语言增强
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/engineering/lan-enhancement/scss/scss.html" class="nav-link">
  Scss
</a></li><li class="dropdown-subitem"><a href="/engineering/lan-enhancement/typescript.html" class="nav-link">
  TypeScript
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          FE
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/framework/vue/" class="nav-link router-link-active">
  Vue
</a></li><li class="dropdown-subitem"><a href="/framework/react/" class="nav-link">
  React
</a></li><li class="dropdown-subitem"><a href="/framework/angular/" class="nav-link">
  Angular
</a></li></ul></li><li class="dropdown-item"><h4>
          BE
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/backend/nodejs/" class="nav-link">
  Node.js
</a></li><li class="dropdown-subitem"><a href="/backend/express/" class="nav-link">
  Express
</a></li><li class="dropdown-subitem"><a href="/backend/koa/" class="nav-link">
  Koa
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="客户端" class="dropdown-title"><span class="title">客户端</span> <span class="arrow down"></span></button> <button type="button" aria-label="客户端" class="mobile-dropdown-title"><span class="title">客户端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/client/jsbridge/" class="nav-link">
  JSBridge
</a></li><li class="dropdown-item"><!----> <a href="/client/electron/" class="nav-link">
  Electron
</a></li><li class="dropdown-item"><!----> <a href="/client/react-native/" class="nav-link">
  React Native
</a></li><li class="dropdown-item"><!----> <a href="/client/flutter/" class="nav-link">
  Flutter
</a></li><li class="dropdown-item"><!----> <a href="/client/cordova/" class="nav-link">
  Cordova
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><span class="title">工具</span> <span class="arrow down"></span></button> <button type="button" aria-label="工具" class="mobile-dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          SEO
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/tool/seo/gtm.html" class="nav-link">
  GTM
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端发展" class="dropdown-title"><span class="title">前端发展</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端发展" class="mobile-dropdown-title"><span class="title">前端发展</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend-development/ssr/" class="nav-link">
  SSR
</a></li><li class="dropdown-item"><!----> <a href="/frontend-development/micro-frontend/" class="nav-link">
  微前端
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/other/team/private-npm.html" class="nav-link">
  团队协作
</a></li><li class="dropdown-item"><!----> <a href="/other/project-manage/" class="nav-link">
  项目管理
</a></li><li class="dropdown-item"><!----> <a href="/other/design/" class="nav-link">
  架构设计
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/SandLZ" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Vue</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/framework/vue/" aria-current="page" class="sidebar-link">Vue</a></li><li><a href="/framework/vue/vue/base.html" class="sidebar-link">基础</a></li><li><a href="/framework/vue/vue/app.html" class="sidebar-link">应用</a></li><li><a href="/framework/vue/vue/component.html" class="sidebar-link">组件</a></li><li><a href="/framework/vue/vue/transition.html" class="sidebar-link">过渡 &amp; 动画</a></li><li><a href="/framework/vue/vue/multiplex-composition.html" class="sidebar-link">可复用 &amp; 组合</a></li><li><a href="/framework/vue/vue/watch.html" class="sidebar-link">Watch</a></li><li><a href="/framework/vue/vue/data-bind.html" aria-current="page" class="active sidebar-link">双向绑定</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/framework/vue/vue/data-bind.html#流程梳理" class="sidebar-link">流程梳理</a></li><li class="sidebar-sub-header"><a href="/framework/vue/vue/data-bind.html#数组处理" class="sidebar-link">数组处理</a></li><li class="sidebar-sub-header"><a href="/framework/vue/vue/data-bind.html#问题" class="sidebar-link">问题</a></li><li class="sidebar-sub-header"><a href="/framework/vue/vue/data-bind.html#参考" class="sidebar-link">参考</a></li></ul></li><li><a href="/framework/vue/vue/ssr.html" class="sidebar-link">SSR</a></li><li><a href="/framework/vue/vue/qa.html" class="sidebar-link">QA</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vuex</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue Router</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>QA</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="双向绑定"><a href="#双向绑定" class="header-anchor">#</a> 双向绑定</h1> <blockquote><p>Vue 通过<code>数据劫持</code> + <code>发布订阅模式</code>实现数据的双向绑定.</p></blockquote> <p>原理：<code>Object.defineProperty</code>来劫持各个属性的<code>getter</code>、<code>setter</code>，在数据变动时发送消息给订阅者，触发相应的监听回调。</p> <h2 id="流程梳理"><a href="#流程梳理" class="header-anchor">#</a> 流程梳理</h2> <ol><li>实现一个数据监听器<code>Observer</code>，能够对数据对象的所有属性进行监听，如有变动可拿到最新值并通知订阅者</li> <li>实现一个指令解析器<code>Compile</code>，对每个元素节点的指令进行扫描和解析，根据指令模板替换数据，以及绑定相应的更新函数</li> <li>实现一个<code>Watcher</code>，作为连接<code>Observer</code>和<code>Compile</code>的桥梁，能够订阅并收到每个属性变动的通知，执行指令绑定的相应回调函数，从而更新视图</li></ol> <p><img src="https://github.com/sandlz/images/raw/master/uPic/2.png" alt="流程"></p> <h3 id="observer"><a href="#observer" class="header-anchor">#</a> Observer</h3> <p>利用<code>Object.defineProperty</code>来监听属性的变化，需要将数据对象递归遍历，包括子属性对象的属性，这样属性值变化后，会触发<code>setter</code>，就可以监听到属性的变化。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">info</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token string">&quot;aaa&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token function">observe</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
data<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;yyy&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">observe</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>data <span class="token operator">||</span> <span class="token keyword">typeof</span> data <span class="token operator">!==</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 对所有属性遍历</span>
  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">defineReactive</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">,</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">defineReactive</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 监听子属性</span>
  <span class="token function">observe</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 可枚举</span>
    <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 不能再define</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> val<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;监听到值变化了 &quot;</span><span class="token punctuation">,</span> val<span class="token punctuation">,</span> <span class="token string">&quot; --&gt; &quot;</span><span class="token punctuation">,</span> newVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
      val <span class="token operator">=</span> newVal<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>我们已经可以监听每个数据的变化了，那么监听到变化之后就是怎么通知订阅者?
所以接下来我们需要实现一个消息订阅器，很简单，维护一个数组，用来收集订阅者，数据变动触发 notify，再调用订阅者的 update 方法</p> <p>明确订阅者应该是<code>Watcher</code>, 而且<code>var dep = new Dep()</code>;是在<code>defineReactive</code>方法内部定义的，所以想通过 dep 添加订阅者，就必须要在闭包内操作，所以我们可以在<code>getter</code>里面动手脚
Observer.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">defineReactive</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span> key<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> dep <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dep</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 监听子属性</span>
  <span class="token function">observe</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 可枚举</span>
    <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 不能再define</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 由于需要在闭包内添加watcher，所以通过Dep定义一个全局target属性，暂存watcher, 添加完移除</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>Dep<span class="token punctuation">.</span>target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        dep<span class="token punctuation">.</span><span class="token function">depend</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> val<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">newVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;监听到值变化了 &quot;</span><span class="token punctuation">,</span> val<span class="token punctuation">,</span> <span class="token string">&quot; --&gt; &quot;</span><span class="token punctuation">,</span> newVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
      val <span class="token operator">=</span> newVal<span class="token punctuation">;</span>
      <span class="token comment">// 通知订阅者</span>
      dep<span class="token punctuation">.</span><span class="token function">notify</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Dep</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>subs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token class-name">Dep</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">addSub</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">sub</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>sub<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">depend</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Dep<span class="token punctuation">.</span>target<span class="token punctuation">.</span><span class="token function">addDep</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">notify</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">sub</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      sub<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Watcher.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Watcher</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Dep<span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token comment">// 这里会触发属性的getter，从而添加订阅者</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
    Dep<span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="compile"><a href="#compile" class="header-anchor">#</a> Compile</h3> <p><code>Compile</code>主要做的事情是解析模板指令，将模板中的变量替换成数据，然后初始化渲染页面视图，并将每个指令对应的节点绑定更新函数，添加监听数据的订阅者，一旦数据有变动，收到通知，更新视图</p> <p><img src="https://github.com/sandlz/images/raw/master/uPic/3.png" alt=""></p> <p>因为遍历解析的过程有多次操作<code>dom</code>节点，为提高性能和效率，会先将<code>vue</code>实例根节点的<code>el</code>转换成文档碎片<code>fragment</code>进行解析编译操作，解析完成，再将<code>fragment</code>添加回原来的真实 dom 节点中</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Compile</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>$el <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isElementNode</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span> <span class="token operator">?</span> el <span class="token operator">:</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$fragment <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">node2Fragment</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$fragment<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token class-name">Compile</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">init</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">compileElement</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$fragment<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">node2Fragment</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> fragment <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createDocumentFragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      child<span class="token punctuation">;</span>
    <span class="token comment">// 将原生节点拷贝到fragment</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>child <span class="token operator">=</span> el<span class="token punctuation">.</span>firstChild<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      fragment<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>child<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> fragment<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p><code>compileElement</code>方法将遍历所有节点及其子节点，进行扫描解析编译，调用对应的指令渲染函数进行数据渲染，并调用对应的指令更新函数进行绑定，详看代码及注释说明：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token class-name">Compile</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ... 省略</span>
  <span class="token function-variable function">compileElement</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> childNodes <span class="token operator">=</span> el<span class="token punctuation">.</span>childNodes<span class="token punctuation">,</span>
      me <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>childNodes<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> text <span class="token operator">=</span> node<span class="token punctuation">.</span>textContent<span class="token punctuation">;</span>
      <span class="token keyword">var</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\{\{(.*)\}\}</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">;</span> <span class="token comment">// 表达式文本</span>
      <span class="token comment">// 按元素节点方式编译</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>me<span class="token punctuation">.</span><span class="token function">isElementNode</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        me<span class="token punctuation">.</span><span class="token function">compile</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>me<span class="token punctuation">.</span><span class="token function">isTextNode</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> reg<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        me<span class="token punctuation">.</span><span class="token function">compileText</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> RegExp<span class="token punctuation">.</span>$1<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 遍历编译子节点</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>childNodes <span class="token operator">&amp;&amp;</span> node<span class="token punctuation">.</span>childNodes<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        me<span class="token punctuation">.</span><span class="token function">compileElement</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function-variable function">compile</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> nodeAttrs <span class="token operator">=</span> node<span class="token punctuation">.</span>attributes<span class="token punctuation">,</span>
      me <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>nodeAttrs<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">attr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 规定：指令以 v-xxx 命名</span>
      <span class="token comment">// 如 &lt;span v-text=&quot;content&quot;&gt;&lt;/span&gt; 中指令为 v-text</span>
      <span class="token keyword">var</span> attrName <span class="token operator">=</span> attr<span class="token punctuation">.</span>name<span class="token punctuation">;</span> <span class="token comment">// v-text</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>me<span class="token punctuation">.</span><span class="token function">isDirective</span><span class="token punctuation">(</span>attrName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> exp <span class="token operator">=</span> attr<span class="token punctuation">.</span>value<span class="token punctuation">;</span> <span class="token comment">// content</span>
        <span class="token keyword">var</span> dir <span class="token operator">=</span> attrName<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// text</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>me<span class="token punctuation">.</span><span class="token function">isEventDirective</span><span class="token punctuation">(</span>dir<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 事件指令, 如 v-on:click</span>
          compileUtil<span class="token punctuation">.</span><span class="token function">eventHandler</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> me<span class="token punctuation">.</span>$vm<span class="token punctuation">,</span> exp<span class="token punctuation">,</span> dir<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token comment">// 普通指令</span>
          compileUtil<span class="token punctuation">[</span>dir<span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> compileUtil<span class="token punctuation">[</span>dir<span class="token punctuation">]</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> me<span class="token punctuation">.</span>$vm<span class="token punctuation">,</span> exp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 指令处理集合</span>
<span class="token keyword">var</span> compileUtil <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">text</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">node<span class="token punctuation">,</span> vm<span class="token punctuation">,</span> exp</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> vm<span class="token punctuation">,</span> exp<span class="token punctuation">,</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// ...省略</span>
  <span class="token function-variable function">bind</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">node<span class="token punctuation">,</span> vm<span class="token punctuation">,</span> exp<span class="token punctuation">,</span> dir</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> updaterFn <span class="token operator">=</span> updater<span class="token punctuation">[</span>dir <span class="token operator">+</span> <span class="token string">&quot;Updater&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// 第一次初始化视图</span>
    updaterFn <span class="token operator">&amp;&amp;</span> <span class="token function">updaterFn</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> vm<span class="token punctuation">[</span>exp<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 实例化订阅者，此操作会在对应的属性消息订阅器中添加了该订阅者watcher</span>
    <span class="token keyword">new</span> <span class="token class-name">Watcher</span><span class="token punctuation">(</span>vm<span class="token punctuation">,</span> exp<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> oldValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 一旦属性值有变化，会收到通知执行此更新函数，更新视图</span>
      updaterFn <span class="token operator">&amp;&amp;</span> <span class="token function">updaterFn</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> value<span class="token punctuation">,</span> oldValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 更新函数</span>
<span class="token keyword">var</span> updater <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">textUpdater</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">node<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    node<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token keyword">typeof</span> value <span class="token operator">==</span> <span class="token string">&quot;undefined&quot;</span> <span class="token operator">?</span> <span class="token string">&quot;&quot;</span> <span class="token operator">:</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// ...省略</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>这里通过递归遍历保证了每个节点及子节点都会解析编译到，包括了{{}}表达式声明的文本节点。指令的声明规定是通过特定前缀的节点属性来标记，如<code>&lt;span v-text=&quot;content&quot; other-attr中v-text便是指令，而other-attr不是指令，只是普通的属性</code>。
监听数据、绑定更新函数的处理是在<code>compileUtil.bind()</code>这个方法中，通过<code>new Watcher()</code>添加回调来接收数据变化的通知</p> <h3 id="watcher"><a href="#watcher" class="header-anchor">#</a> Watcher</h3> <p><code>Watcher</code>订阅者作为<code>Observer</code>和<code>Compile</code>之间通信的桥梁，主要做的事情是:</p> <ol><li>在自身实例化时往属性订阅器<code>(dep)</code>里面添加自己</li> <li>自身必须有一个<code>update()</code>方法</li> <li>待属性变动<code>dep.notice()</code>通知时，能调用自身的<code>update()</code>方法，并触发<code>Compile</code>中绑定的回调。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Watcher</span><span class="token punctuation">(</span><span class="token parameter">vm<span class="token punctuation">,</span> exp<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>cb <span class="token operator">=</span> cb<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>vm <span class="token operator">=</span> vm<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>exp <span class="token operator">=</span> exp<span class="token punctuation">;</span>
  <span class="token comment">// 此处为了触发属性的getter，从而在dep添加自己，结合Observer更易理解</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">Watcher</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">update</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 属性值变化收到通知</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">run</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 取到最新值</span>
    <span class="token keyword">var</span> oldVal <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">!==</span> oldVal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">cb</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">,</span> value<span class="token punctuation">,</span> oldVal<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 执行Compile中绑定的回调，更新视图</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Dep<span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token comment">// 将当前订阅者指向自己</span>
    <span class="token keyword">var</span> value <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>vm<span class="token punctuation">[</span>exp<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 触发getter，添加自己到属性订阅器中</span>
    Dep<span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// 添加完毕，重置</span>
    <span class="token keyword">return</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 这里再次列出Observer和Dep，方便理解</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 由于需要在闭包内添加watcher，所以可以在Dep定义一个全局target属性，暂存watcher, 添加完移除</span>
    Dep<span class="token punctuation">.</span>target <span class="token operator">&amp;&amp;</span> dep<span class="token punctuation">.</span><span class="token function">addDep</span><span class="token punctuation">(</span>Dep<span class="token punctuation">.</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> val<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// ... 省略</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">Dep</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">notify</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>subs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">sub</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 调用订阅者的update方法，通知变化</span>
      sub<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>实例化<code>Watcher</code>的时候，调用<code>get()</code>方法，通过<code>Dep.target = watcherInstance</code>标记订阅者是当前<code>watcher</code>实例，强行触发属性定义的<code>getter</code>方法，<code>getter</code>方法执行的时候，就会在属性的订阅器 dep 添加当前<code>watcher</code>实例，从而在属性值有变化的时候，<code>watcherInstance</code>就能收到更新通知</p> <h2 id="数组处理"><a href="#数组处理" class="header-anchor">#</a> 数组处理</h2> <p>以 <code>Array.prototype</code> 为原型，创建了一个 <code>arrayMethods</code> 的对象（ <code>Object.create（Array.prototype）</code>），然后使用了一个强硬的手段，es6 的语法，<code>Object.setPrototypeOf(obj, arrayMethods)</code>，强制的让 数组 的原型 <strong>proto</strong>指向了 arrayMethods，这样就会触发重写的数组方法。</p> <p>Vue 不能检测以下数组的变动：</p> <ol><li>当你利用索引直接设置一个数组项时，例如：<code>vm.items[indexOfItem] = newValue</code></li> <li>当你修改数组的长度时，例如：<code>vm.items.length = newLength</code></li></ol> <p>针对问题一：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Vue.set</span>
Vue<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>items<span class="token punctuation">,</span> indexOfItem<span class="token punctuation">,</span> newValue<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 或者 Array.prototype.splice</span>
vm<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>indexOfItem<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> newValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>你也可以使用 <code>vm.$set</code> 实例方法，该方法是全局方法 <code>Vue.set</code> 的一个别名：</p> <div class="language-js extra-class"><pre class="language-js"><code>vm<span class="token punctuation">.</span><span class="token function">$set</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>items<span class="token punctuation">,</span> indexOfItem<span class="token punctuation">,</span> newValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>针对问题二：</p> <div class="language-js extra-class"><pre class="language-js"><code>vm<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>newLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="问题"><a href="#问题" class="header-anchor">#</a> 问题</h2> <h3 id="动态添加响应式-property"><a href="#动态添加响应式-property" class="header-anchor">#</a> 动态添加响应式 <code>property</code></h3> <p>对于已经创建的实例，Vue 不允许动态添加根级别的响应式 <code>property</code>。但是，可以使用 <code>Vue.set(object, propertyName, value)</code> 方法向嵌套对象添加响应式 <code>property</code>。例如，对于：</p> <div class="language-js extra-class"><pre class="language-js"><code>Vue<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>vm<span class="token punctuation">.</span>someObject<span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>您还可以使用 <code>vm.$set</code> 实例方法，这也是全局 <code>Vue.set</code> 方法的别名：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$set</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>someObject<span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>有时你可能需要为已有对象赋值多个新 property，比如使用 <code>Object.assign()</code> 或 <code>_.extend()</code>。但是，这样添加到对象上的新 <code>property</code> 不会触发更新。在这种情况下，你应该用原对象与要混合进去的对象的 property 一起创建一个新的对象。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 代替 `Object.assign(this.someObject, { a: 1, b: 2 })`</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>someObject <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>someObject<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">a</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <ul><li><a href="https://juejin.cn/post/6844903854740340749" target="_blank" rel="noopener noreferrer">MVVM<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/DMQ/mvvm" target="_blank" rel="noopener noreferrer">源码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">3/22/2023, 7:54:54 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/framework/vue/vue/watch.html" class="prev">
        Watch
      </a></span> <span class="next"><a href="/framework/vue/vue/ssr.html">
        SSR
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.3cc20051.js" defer></script><script src="/assets/js/3.d21fe4c7.js" defer></script><script src="/assets/js/141.e7473c8f.js" defer></script>
  </body>
</html>
